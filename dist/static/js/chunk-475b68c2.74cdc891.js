(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-475b68c2"],{1051:function(t,e,n){"use strict";var s=n("ced4"),a=n.n(s);a.a},"1af6":function(t,e,n){var s=n("63b6");s(s.S,"Array",{isArray:n("9003")})},"2e08":function(t,e,n){var s=n("9def"),a=n("9744"),o=n("be13");t.exports=function(t,e,n,r){var i=String(o(t)),c=i.length,l=void 0===n?" ":String(n),u=s(e);if(u<=c||""==l)return i;var g=u-c,f=a.call(l,Math.ceil(g/l.length));return f.length>g&&(f=f.slice(0,g)),r?f+i:i+f}},3846:function(t,e,n){n("9e1e")&&"g"!=/./g.flags&&n("86cc").f(RegExp.prototype,"flags",{configurable:!0,get:n("0bfb")})},4917:function(t,e,n){"use strict";var s=n("cb7c"),a=n("9def"),o=n("0390"),r=n("5f1b");n("214f")("match",1,(function(t,e,n,i){return[function(n){var s=t(this),a=void 0==n?void 0:n[e];return void 0!==a?a.call(n,s):new RegExp(n)[e](String(s))},function(t){var e=i(n,t,this);if(e.done)return e.value;var c=s(t),l=String(this);if(!c.global)return r(c,l);var u=c.unicode;c.lastIndex=0;var g,f=[],h=0;while(null!==(g=r(c,l))){var A=String(g[0]);f[h]=A,""===A&&(c.lastIndex=o(l,a(c.lastIndex),u)),h++}return 0===h?null:f}]}))},"549b":function(t,e,n){"use strict";var s=n("d864"),a=n("63b6"),o=n("241e"),r=n("b0dc"),i=n("3702"),c=n("b447"),l=n("20fd"),u=n("7cd6");a(a.S+a.F*!n("4ee1")((function(t){Array.from(t)})),"Array",{from:function(t){var e,n,a,g,f=o(t),h="function"==typeof this?this:Array,A=arguments.length,d=A>1?arguments[1]:void 0,v=void 0!==d,m=0,p=u(f);if(v&&(d=s(d,A>2?arguments[2]:void 0,2)),void 0==p||h==Array&&i(p))for(e=c(f.length),n=new h(e);e>m;m++)l(n,m,v?d(f[m],m):f[m]);else for(g=p.call(f),n=new h;!(a=g.next()).done;m++)l(n,m,v?r(g,d,[a.value,m],!0):a.value);return n.length=m,n}})},"54a1":function(t,e,n){n("6c1c"),n("1654"),t.exports=n("95d5")},"6b54":function(t,e,n){"use strict";n("3846");var s=n("cb7c"),a=n("0bfb"),o=n("9e1e"),r="toString",i=/./[r],c=function(t){n("2aba")(RegExp.prototype,r,t,!0)};n("79e5")((function(){return"/a/b"!=i.call({source:"a",flags:"b"})}))?c((function(){var t=s(this);return"/".concat(t.source,"/","flags"in t?t.flags:!o&&t instanceof RegExp?a.call(t):void 0)})):i.name!=r&&c((function(){return i.call(this)}))},"71db":function(t,e){t.exports="data:image/png;base64,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"},"75fc":function(t,e,n){"use strict";var s=n("a745"),a=n.n(s);function o(t){if(a()(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}var r=n("774e"),i=n.n(r),c=n("c8bb"),l=n.n(c);function u(t){if(l()(Object(t))||"[object Arguments]"===Object.prototype.toString.call(t))return i()(t)}function g(){throw new TypeError("Invalid attempt to spread non-iterable instance")}function f(t){return o(t)||u(t)||g()}n.d(e,"a",(function(){return f}))},"774e":function(t,e,n){t.exports=n("d2d5")},"95d5":function(t,e,n){var s=n("40c3"),a=n("5168")("iterator"),o=n("481b");t.exports=n("584a").isIterable=function(t){var e=Object(t);return void 0!==e[a]||"@@iterator"in e||o.hasOwnProperty(s(e))}},9744:function(t,e,n){"use strict";var s=n("4588"),a=n("be13");t.exports=function(t){var e=String(a(this)),n="",o=s(t);if(o<0||o==1/0)throw RangeError("Count can't be negative");for(;o>0;(o>>>=1)&&(e+=e))1&o&&(n+=e);return n}},a745:function(t,e,n){t.exports=n("f410")},a7a5:function(t,e){t.exports="data:image/png;base64,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"},b42b:function(t,e,n){"use strict";n.r(e);var s=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"main"},[s("section",{staticClass:"left"},[s("div",{staticClass:"list-box"},[s("div",{staticClass:"inner-warpper"},t._l(t.sessionList,(function(e,n){return s("div",{key:e.targetId+n,staticClass:"content-warpper",on:{click:function(n){return t.changeChat(e.targetId)}}},[s("span",{staticClass:"clearMessage el-icon-close",on:{click:function(n){return t.clearBox(e.targetId)}}}),t._v(" "),s("span",{directives:[{name:"show",rawName:"v-show",value:e.unreadMessageCount,expression:"item.unreadMessageCount"}],staticClass:"message-tip"},[t._v(t._s(e.unreadMessageCount))]),t._v(" "),s("img",{attrs:{src:e.user&&e.user.portrait||"",alt:""}}),t._v(" "),s("div",{staticClass:"warpper-content"},[s("div",{staticClass:"font"},[s("span",[t._v(t._s(e.user&&e.user.name||"神秘用户"))]),t._v(" "),s("span",[t._v(t._s(t._f("timeStr")(e.latestMessage.sentTime)))])]),t._v(" "),"RC:ImgMsg"===e.objectName?s("span",{staticClass:"message-content"},[t._v("收到一条图片消息")]):"RC:FileMsg"===e.objectName?s("span",{staticClass:"message-content"},[t._v("收到一条附件消息")]):s("span",{staticClass:"message-content"},[t._v(t._s(e.latestMessage.content.content))])])])})),0)])]),t._v(" "),s("section",{staticClass:"right"},[s("div",{ref:"chat",staticClass:"chat-box"},[s("div",{staticClass:"chat-box-top"},[s("div",{staticClass:"title"},[t._v(t._s(t.firstUser&&t.firstUser.name))]),t._v(" "),s("div",{ref:"chatContent",staticClass:"chat-main",on:{"&scroll":function(e){return t.getScroll(e)}}},[s("span",{directives:[{name:"show",rawName:"v-show",value:t.hasMsg,expression:"hasMsg"}],staticClass:"scroll-more"},[t._v("上拉加载更多")]),t._v(" "),t._l(t.messageContent,(function(e,a){return s("div",{key:e.sentTime+a,staticClass:"bubble",class:[e&&1==e.messageDirection?"master":"guest"]},[e&&1!==e.messageDirection?s("img",{staticClass:"photo",attrs:{src:e.content.user&&e.content.user.portrait,alt:""}}):t._e(),t._v(" "),s("div",{staticClass:"bubble-content"},["ImageMessage"===e.content.messageName?s("el-link",{staticClass:"img-boxs",attrs:{target:"_blank",href:e.content.imageUri}},[s("img",{attrs:{src:e.content.imageUri,alt:"",width:"100"}})]):t._e(),t._v(" "),"TextMessage"===e.content.messageName?s("span",[t._v(t._s(e.content.content))]):t._e(),t._v(" "),"FileMessage"===e.content.messageName?s("el-link",{attrs:{target:"_blank",href:e.content.fileUrl}},[s("div",{staticClass:"file-box"},[s("img",{attrs:{src:n("71db"),alt:"",height:"40",width:"40"}}),t._v(" "),s("span",[t._v(t._s(e.content.name))])])]):t._e()],1)])}))],2)]),t._v(" "),s("div",{staticClass:"chat-box-bottom"},[s("div",{staticClass:"tool"},[s("el-upload",{staticClass:"uploader",attrs:{action:t.uploadPic,name:"multipartFile","show-file-list":!1,"on-success":t.pushImgMsg}},[s("img",{attrs:{src:n("a7a5"),alt:""}})])],1),t._v(" "),s("el-input",{staticClass:"textarea",attrs:{type:"textarea",resize:"none"},nativeOn:{keyup:function(e){return t.enterInput(e)}},model:{value:t.text,callback:function(e){t.text=e},expression:"text"}}),t._v(" "),s("div",{staticClass:"btn-box"},[s("el-button",{staticClass:"enter-btn",on:{click:t.onSend}},[t._v("发送")]),t._v(" "),s("span",{staticClass:"fonts"},[t._v("按Enter键发送，按Ctrl+Enter键换行")])],1)],1)])]),t._v(" "),s("el-dialog",{attrs:{visible:t.boxFlag},on:{close:function(e){t.boxFlag=!1}}},[s("h6",{staticClass:"dialog-title",attrs:{slot:"title"},slot:"title"},[t._v("警告")]),t._v(" "),s("div",{staticClass:"dialog-box"},[s("span",[t._v("删除后将无法和该学员联系是否删除？")])]),t._v(" "),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(e){t.boxFlag=!1}}},[t._v("取消")]),t._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:t.clearMessage}},[t._v("删除")])],1)])],1)},a=[],o=(n("4917"),n("75fc")),r=(n("ac6a"),n("6bcb")),i=n("c466");function c(t,e,n){var s=null,a=null;return function(){var o=+new Date;a||(a=o),n&&o-a>n?(t(),a=o,clearTimeout(s)):(clearTimeout(s),s=setTimeout((function(){t(),a=null}),e))}}var l=n("39bb"),u=n("b775");function g(t){return u["a"].post("/boss/v2/rongCloud/userInfo",t)}var f=n("60f0"),h=window.RongIMLib,A=h.RongIMClient,d={name:"Message",filters:{timeStr:function(t){return t&&Object(i["a"])(t,"hh:mm")||"刚刚"}},mixins:[r["a"],f["a"]],data:function(){return{text:"好的，我知道了",messageList:[],sessionList:[],firstId:null,uploadPic:l["c"],messageContent:[],hasMsg:!1,firstUser:null,delId:null,boxFlag:!1,fileList:[],scrollTo:1,initHistory:!0,sequence:!0,getScroll:null,firstDo:!0,result:"",scrollBottom:!0,newSessionList:[],newId:"",users:{}}},computed:{flag:function(){return this.$store.state.user.messageInit}},watch:{flag:{handler:function(){this.flag&&this.fetchMessageList()},immediate:!0},sessionList:{handler:function(t,e){if(this.firstDo){this.firstDo=!1,this.firstId=this.newId||this.sessionList[0].targetId;var n=[];this.sessionList.forEach((function(t){n.push(t.targetId)})),this.getInfo(n)}},deep:!0},firstId:function(){this.getMessage(),this.firstUser=this.users[this.firstId]}},created:function(){var t=this.$route.query.id;t&&(this.newId=t),this.getScroll=c(this.paperScroll,300)},methods:{getInfo:function(t){var e=this,n=Object(o["a"])(t);g(n).then((function(t){if(t.code)return t.message&&e.$warn(t.message);e.users=t.data,e.sessionList.forEach((function(n){e.$set(n,"user",t.data[n.targetId])}))}))},pushImgMsg:function(t,e){if(t.code)return t.message&&this.$warn(t.message);var n=new FileReader;n.readAsDataURL(e.raw);var s=this;n.onload=function(e){var n=this.result,a=t.data,o=new h.ImageMessage({content:n,imageUri:a}),r=h.ConversationType.PRIVATE,i=s.firstId,c={onSuccess:function(t){s.messageContent.push(t),s.scrollBottom=!0,s.onScroller()},onError:function(t){console.log("发送图片消息失败",t)}};A.getInstance().sendMessage(r,i,o,c)}},changeChat:function(t){this.firstId=t,this.scrollBottom=!0,this.messageContent=[],this.sequence=!0},enterInput:function(t){13===t.keyCode&&t.ctrlKey?this.text+="\n":13===t.keyCode&&(this.onSend(),t.preventDefault())},onSend:function(){if(this.text){if(this.text.match(/^[ ]*$/))return this.$dialog({title:"错误",content:"不能为空",cancelBtnTxt:"知道了",noOkBtn:!0}),!1;var t={content:this.text,extra:""},e=new h.TextMessage(t),n=h.ConversationType.PRIVATE,s=this.firstId,a=this;A.getInstance().sendMessage(n,s,e,{onSuccess:function(t){a.text="",a.messageContent.push(t),a.scrollBottom=!0,a.onScroller()},onError:function(t){console.log("发送文本消息失败",t)}})}else this.$dialog({title:"错误",content:"不能为空",cancelBtnTxt:"知道了",noOkBtn:!0})},clearBox:function(t){this.boxFlag=!0,this.delId=t},fetchMessageList:function(){var t=[h.ConversationType.PRIVATE],e=150,n=this;A.getInstance().getConversationList({onSuccess:function(t){n.sessionList=t},onError:function(t){console.log("获取会话列表失败",t)}},t,e)},getMessage:function(){if(this.firstId){var t=h.ConversationType.PRIVATE,e=this.firstId,n=null,s=10;this.sequence?n=0:this.messageContent.length>0&&(n=this.messageContent[0].sentTime),this.initHistory=!1;var a=this;h.RongIMClient.getInstance().getHistoryMessages(t,e,n,s,{onSuccess:function(t,e){if(console.log(t),a.hasMsg=e,a.sequence){for(var n=0;n<t.length;n++)t[n].action=!1,a.messageContent.push(t[n]);a.onScroller(),a.sequence=!1}else{for(var s=t.reverse(),o=0;o<s.length;o++)a.messageContent.unshift(t[o]);a.onScroller()}a.clearUnRead()},onError:function(t){console.log("获取历史消息失败",t)}})}},clearUnRead:function(){var t=h.ConversationType.PRIVATE,e=this.firstId;A.getInstance().clearUnreadCount(t,e,{onSuccess:function(){},onError:function(t){console.log("清除指定会话未读消息数失败",t)}})},clearMessage:function(){var t=h.ConversationType.PRIVATE,e=this.delId,n=this;A.getInstance().removeConversation(t,e,{onSuccess:function(t){n.boxFlag=!1,n.fetchMessageList()},onError:function(t){console.log("删除指定会话失败",t)}})},onScroller:function(){var t=this;this.$nextTick((function(){t.scrollBottom?(t.$refs.chatContent.scrollTop=t.$refs.chatContent.scrollHeight+100,t.scrollBottom=!1):t.$refs.chatContent.scrollTop=20}))},paperScroll:function(){this.$refs.chatContent.scrollTop<=10&&this.hasMsg&&this.getMessage()}}},v=d,m=(n("1051"),n("2877")),p=Object(m["a"])(v,s,a,!1,null,"1166a231",null);e["default"]=p.exports},c466:function(t,e,n){"use strict";n.d(e,"a",(function(){return s}));n("28a5"),n("f576"),n("a481"),n("6b54"),n("7618");function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"YYYY-MM-DD hh:mm:ss",n=(new Date).getTime();t||(t=n);while(t.toString().length<13)t+="0";var s=new Date(t);s.getMonth();var a={year:s.getFullYear(),month:s.getMonth()+1,day:s.getDate(),hours:s.getHours(),minutes:s.getMinutes(),seconds:s.getSeconds()};switch(a.day<10&&(a.day="0"+a.day),a.minutes<10&&(a.minutes="0"+a.minutes),e){case"YYYY-MM-DD hh:mm:ss":return"".concat(a.year,"-").concat(a.month,"-").concat(a.day," ").concat(a.hours,":").concat(a.minutes,":").concat(a.seconds);case"YYYY-MM-DD":return"".concat(a.year,"-").concat(a.month,"-").concat(a.day);case"MM-DD":return"".concat(a.month,"-").concat(a.day);case"hh:mm:ss":return"".concat(a.hours,":").concat(a.minutes,":").concat(a.seconds);case"hh:mm":return"".concat(a.hours,":").concat(a.minutes);case"computed":if(n>t){var o=Math.abs(t-n),r=o/1e3,i=r/60,c=i/60,l=c/24,u=l/7;if(~~u>0&&u<3)return~~u+"周前";if(l<7&&~~l>0)return~~l+"天前";if(~~c>0&&c<24)return~~c+"小时前";if(~~i>0&&i<60)return~~i+"分钟前";if(~~r>0&&r<60)return~~r+"秒前"}else console.log("未来的时间");return"".concat(a.year,"-").concat(a.month,"-").concat(a.day," ").concat(a.hours,":").concat(a.minutes,":").concat(a.seconds)}}},c8bb:function(t,e,n){t.exports=n("54a1")},ced4:function(t,e,n){},d2d5:function(t,e,n){n("1654"),n("549b"),t.exports=n("584a").Array.from},f410:function(t,e,n){n("1af6"),t.exports=n("584a").Array.isArray},f576:function(t,e,n){"use strict";var s=n("5ca1"),a=n("2e08"),o=n("a25f"),r=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(o);s(s.P+s.F*r,"String",{padStart:function(t){return a(this,t,arguments.length>1?arguments[1]:void 0,!0)}})}}]);